import csv


def main(summary_dict, dev_field, reportfile):
	csvfilename = reportfile[:-5] + '.csv'
	with open(csvfilename,'wb') as csvfile:
		fwriter = csv.writer(csvfile, delimiter = ',', quotechar='|', quoting = csv.QUOTE_MINIMAL)
		fwriter.writerow(['ForestUnit','AgeClass','ProtectionForest_ha','Unavailable_ha','StageOfManagement_%s'%dev_field,'Available_ha'])
		for k, v in summary_dict.items():
			fu = k

			for i in v:
				ageclass = '%s - %s'%(i[0][0], i[0][1])
				protForest = round(i[1],3)
				unavail = round(i[2],3)
				SoM = ' '.join(i[3])
				avail = round(i[4],3)
				multiSoM = i[5]

				if len(multiSoM) == 0:
					fwriter.writerow([fu, str(ageclass), protForest, unavail, str(SoM), avail])
				elif len(multiSoM) > 0:
					SoM = ''
					for k, v in multiSoM.items():
						SoM += '%s(%s); '%(k, round(v,3))
					SoM = SoM[:-2]
					fwriter.writerow([fu, str(ageclass), protForest, unavail, str(SoM), avail])
	return csvfilename







if __name__ == '__main__':
	# Here's an example of summary_dict!
	summary_dict = {'PWUS': [[(0, 20), 0, 0, ['SEEDCUT'], 2.157812164983678, {}], [(21, 40), 0, 59.752761613996924, ['FIRSTCUT'], 0, {}], [(41, 60), 0, 0, ['SEEDCUT'], 32.933513713948095, {}], [(61, 80), 0, 0, ['FIRSTCUT', 'SEEDCUT'], 150.56631454333578, {'FIRSTCUT': 14.752753712293488, 'SEEDCUT': 135.8135608310423}], [(81, 100), 0, 101.44430383625209, ['FIRSTCUT', 'SEEDCUT'], 88.93970965506102, {'FIRSTCUT': 6.614406572651837, 'SEEDCUT': 82.32530308240919}], [(101, 120), 0, 73.14237968716884, ['FIRSTCUT', 'SEEDCUT', 'LASTCUT'], 146.6958031360514, {'FIRSTCUT': 20.211985395036407, 'SEEDCUT': 118.74175852840703, 'LASTCUT': 7.742059212607969}], [(121, 140), 0, 81.49843216822886, ['FIRSTCUT', 'SEEDCUT'], 433.4959828604513, {'FIRSTCUT': 92.40825686588235, 'SEEDCUT': 341.0877259945688}], [(141, 160), 0, 90.01754220918384, ['FIRSTCUT', 'SEEDCUT', 'LASTCUT'], 252.1291400013704, {'FIRSTCUT': 55.869010468459116, 'SEEDCUT': 195.9037385740489, 'LASTCUT': 0.35639095886231914}], [(161, 180), 0, 212.29089750951198, ['FIRSTCUT', 'SEEDCUT'], 141.6576089669355, {'FIRSTCUT': 25.720061925897596, 'SEEDCUT': 115.93754704103792}], [(181, 200), 0, 98.03651321213309, ['FIRSTCUT', 'SEEDCUT'], 86.56166248514968, {'FIRSTCUT': 46.54702072564069, 'SEEDCUT': 40.014641759509004}], [(201, 999), 0, 105.23548504075292, ['FIRSTCUT', 'SEEDCUT'], 323.6264073128545, {'FIRSTCUT': 125.56775236012267, 'SEEDCUT': 198.05865495273187}]], 'SBLO': [[(0, 20), 0.19161567421725043, 136.679301903802, ['CONVENT'], 773.0927321219162, {}], [(21, 40), 0, 256.9233335389366, ['CONVENT'], 440.09350460588456, {}], [(41, 60), 0, 48.00093554569912, ['CONVENT'], 186.09066417246783, {}], [(61, 80), 7.815823850996194, 360.02456425678787, ['CONVENT'], 137.2946260867067, {}], [(81, 100), 52.83237338201987, 405.727368314669, ['CONVENT'], 581.6533045022638, {}], [(101, 120), 34.15894051116006, 402.5592085411448, ['CONVENT'], 1144.2788396884373, {}], [(121, 140), 49.64064837086831, 531.0778802340953, ['CONVENT'], 821.0674935815255, {}], [(141, 160), 4.368807627440401, 123.97836974472092, ['CONVENT'], 256.33443841249556, {}], [(161, 180), 42.9811739571339, 156.75662354493247, ['CONVENT'], 149.64040291479532, {}], [(181, 200), 0, 22.726451471850655, ['CONVENT'], 31.998650194539344, {}], [(201, 999), 0, 0, ['N/A'], 0, {}]], 'PWST': [[(0, 20), 0, 0, ['SEEDTREE'], 17.18204719712069, {}], [(21, 40), 0, 0, ['SEEDTREE'], 2.188266836443779, {}], [(41, 60), 0, 34.02267516175487, ['SEEDTREE'], 0, {}], [(61, 80), 0, 79.77258830407733, ['SEEDTREE'], 10.983107323322455, {}], [(81, 100), 0, 40.80008068366581, ['SEEDTREE'], 59.83601925830305, {}], [(101, 120), 0, 0, ['SEEDTREE'], 85.74222231672633, {}], [(121, 140), 0, 0, ['SEEDTREE'], 37.77926198321545, {}], [(141, 160), 0, 26.83457699611294, ['SEEDTREE'], 14.044613258023372, {}], [(161, 180), 0, 36.42964094694503, ['SEEDTREE'], 32.552419831672715, {}], [(181, 200), 0, 18.903830509310573, ['SEEDTREE'], 8.516961994809217, {}], [(201, 999), 0, 57.943917426864026, ['SEEDTREE'], 13.524878871931692, {}]], 'SF': [[(0, 20), 0, 39.20209641252783, ['CONVENT'], 212.9812395293591, {}], [(21, 40), 0, 142.25424705375622, ['CONVENT'], 228.5038133158642, {}], [(41, 60), 0, 652.9059788947723, ['CONVENT'], 278.88178679784045, {}], [(61, 80), 30.456539537866217, 1267.730224744691, ['CONVENT'], 773.1664913993975, {}], [(81, 100), 134.80470118920252, 2257.7005247815678, ['CONVENT'], 1783.0735207677312, {}], [(101, 120), 22.967398796199454, 1827.6240073474926, ['CONVENT'], 2139.464728358783, {}], [(121, 140), 10.194727599909704, 1380.3948702450218, ['CONVENT'], 2040.7491705548118, {}], [(141, 160), 0, 289.26691979809414, ['CONVENT'], 471.75592713408435, {}], [(161, 180), 0, 158.4637986577358, ['CONVENT'], 188.27289060429936, {}], [(181, 200), 0, 16.234581065729927, ['CONVENT'], 5.879198892287018, {}], [(201, 999), 0, 10.7805048771448, ['CONVENT'], 14.859280673924376, {}]]}
	main(summary_dict, 'NEXTSTG',r'C:\TEMP\csv\samplereport.html')